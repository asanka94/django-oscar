{% extends 'dashboard/layout.html' %}
{% load url from future %}
{% load i18n %}

{% block title %}
    {{ title }} | {% trans "Create product type" %} | {{ block.super }}
{% endblock %}

{% block breadcrumbs %}
    <ul class="breadcrumb">
        <li>
            <a href="{% url 'dashboard:index' %}">{% trans "Dashboard" %}</a>
            <span class="divider">/</span>
        </li>
        <li>
            <a href="{% url 'dashboard:catalogue-class-list' %}">{% trans "Product Type" %}</a>
            <span class="divider">/</span>
        </li>
        <li class="active">{{ title }}</li>
    </ul>
{% endblock %}

{% block headertext %}{{ title }}{% endblock %}

{% block dashboard_content %}
    <div class="table-header">
        <h2>{{ title }}</h2>
    </div>
    <div class="well">
        <form class="form-stacked wysiwyg" method="post">
            {% csrf_token %}

            {% comment %}
                If the ProductClass form has field_errors, partials/form_fields.html
                will render an error message.
                This means that there'll be 2 error messages,
                one from the partial and one from the view. Perhaps there should be
                an option allowing hiding of the error message in the template.
                For now we copy paste what we need from the template.
            {% endcomment %}

            {% if form.non_field_errors %}
                {% for error in form.non_field_errors %}
                    <div class="alert alert-error control-group error">
                        <span class="help-inline"><i class="icon-exclamation-sign"></i> {{ error }}</span>
                    </div>
                {% endfor %}
            {% endif %}

            {% for field in form %}
                {% include 'partials/form_field.html' with field=field %}
            {% endfor %}

            <table class="table table-striped table-bordered form-inline">
                <caption>{% trans "Product Attributes" %}</caption>
                {{ attributes_formset.management_form }}
                {{ attributes_formset.non_form_errors }}
                <thead>
                    <tr>
                        {% for field in attributes_formset.empty_form.visible_fields %}
                            <th>
                                {{ field.label_tag }}
                            </th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for attribute_form in attributes_formset %}
                        <tr>
                            {% for field in attribute_form %}
                                {% if field.is_hidden %}
                                    {{ field }}
                                {% else %}
                                    <td>{% include 'partials/form_field.html' with field=field nolabel=1 %}</td>
                                {% endif %}
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>

            <div class="form-actions">
                <button class="btn btn-large btn-primary" type="submit">{% trans "Save" %}</button>
                {% trans "or" %} <a href="#" onclick="window.history.go(-1);return false" >{% trans "cancel" %}</a>.
            </div>
        </form>
    </div>
{% endblock dashboard_content %}
